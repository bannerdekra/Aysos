# 版本号 V1.0.10
# Agent 项目

这是一个包含开发工具的个人助手项目，支持 Deepseek、Gemini 等多模型，自动代理穿透防火墙，气泡布局自适应，支持多模态文件上传（图片、PDF、视频），集成 Stable Diffusion 本地绘画功能，**新增 LLM Function Calling 框架，支持动态调用外部工具（如百度搜索）获取实时信息**，**✨ 支持静态图片与动态视频背景自由切换（基于 QGraphicsVideoItem 架构）**，**🆕 支持长文本智能折叠，一键展开/收起，可自定义阈值**。

> 自 2025-10-19 以来的关键变化（摘要）
- 气泡功能按钮（复制/删除/修改）会在气泡侧随鼠标垂直位置对齐，离开后延迟隐藏，整体观感更简洁；
- 创作控制面板（Stable Diffusion）顶部空白显著缩短，整体间距与文本域高度更紧凑；
- 主题与折叠等 UI 配置统一迁移至 `SoftWare/Script/config.json`，不再使用 `theme_settings.json`；
- 删除确认采用单次确认对话框，避免重复确认弹窗。

# 开发准则（暂）

1.所有代码操作都必须写进日志文件夹 LOG（每日或每提交写一次），撰写LOG格式：时间+进度+其他（比如接下来的工作的实现方向，可不写）
LOG 例子：
2025.9.27
（1）.实现功能深色模式
（2）.实现根据系统时间自动切换深色模式
其他：讨论添加新功能

2.所有代码新添加的功能脚本都需要在 README-项目结构 中写明作用（每日或每提交写一次）
3.使用文本开发工具撰写提示词，该工具有存档方便溯源（开发者本地保存）
4.有任何新方向均需要完成以下完整的开发链条：提出idea——阐述目的——讨论必要性——论述可行性（技术路线）——执行改动
5.无论是否完成开发工作每日必须存档提交，github库的存档是可以选择性删除的只是一个保存平台，方便取用最新的开发版本
6.不允许同时编辑项目！！！需沟通协商各自的开发时间，确保每一时刻只有一个人在编辑该项目，每次编辑开始时都应该pull或者clone仓库再开始开发，确保项目进度统一

## 项目结构（2025-10-24）

- `SoftWare/Script/` - 所有脚本文件
  - `main.py` - 主程序
  - `api_client.py` - AI API调用（支持 Gemini/DeepSeek，官方SDK集成，**Function Calling 支持**）
  - `api_config.py` - API配置与自动代理设置
  - `model_registry.py` - **[2025-10-16]** AI模型统一配置中心（DeepSeek、Gemini、Claude、GPT-4o预置）
  - `baidu_searcher.py` - **[2025-10-16]** 百度千帆搜索工具封装（270行）
  - `tool_executor.py` - **[2025-10-16]** 通用工具执行器和注册管理（280行）
  - `chat_area.py` - **[2025-10-19]** 聊天区域，气泡布局优化，支持气泡删除，文件引用显示，SD生成进度实时显示，**长文本智能折叠**
  - `bubble_copy_handler.py` - 对话气泡复制/删除/修改按钮，支持随鼠标高度动态对齐与延迟隐藏
  - `chat_ui.py` - **[2025-10-19]** 聊天界面UI，基于 QGraphicsVideoItem 架构实现视频背景，**修复对话框背景透明问题**
  - `database_manager.py` - 数据库/DSN管理
  - `dialogs.py` - **[2025-10-19]** 软件弹窗类，文件上传模式提示增强，支持背景类型显示，**长文本折叠配置界面**
  - `file_manager.py` - 本地对话管理，支持消息删除
  - `gemini_context_manager.py` - Gemini上下文与文件上传管理，支持视频理解，仅限图片/PDF/视频
  - `input_bar.py` - 输入栏，支持多模态文件上传，SD生图触发
  - `image_generator.py` - Stable Diffusion 图像生成管理器
  - `creation_panel.py` - SD创作控制面板（动态单词计数，参数持久化；间距与高度更紧凑）
  - `sd_config.py` - **[2025-10-16]** SD参数持久化配置管理
  - `responsive_switch.py` - 响应式切换
  - `sidebar.py` - 任务管理栏
  - `storage_config.py` - DSN逻辑切换，支持文件存储删除
  - `theme_manager.py` - **[2025-10-18] 主题管理，支持静态/动态背景自由切换**（配置改为统一写入 `config.json`）
  - `enhanced_theme_manager.py` - **[2025-10-18] 增强主题管理器，支持视频背景标记与自动识别**（配置改为统一写入 `config.json`）
  - `config.json` - 全局统一配置（主题深浅色、自动模式、自定义背景、UI 折叠阈值与预览长度等）
- `SoftWare/Image/` - 软件资源
  - `Backgroud/` - UI背景图片
  - `loading/` - Agent回答加载中GIF
- `SoftWare/Icon/` - 软件封装图标
  - `sentence/summary.md` - 更新内容摘要
- `TOOL/` - **[2025-10-17]** 诊断与测试工具
  - `test_video_fixes.py` - 视频背景修复测试（完整版）
  - `test_video_fixes_simplified.py` - 视频背景修复测试（简化版）
  - `simple_video_test.py` / `standalone_video_test.py` / `minimal_video_test.py` - 视频组件基础测试
- `LOG/` - 日志与说明
  - `LOG/UPDATE_2025-09-28.md` / `UPDATE_2025-09-30.md` / `UPDATE_2025-10-05.md` / `UPDATE_2025-10-08.md` / `UPDATE_2025-10-09.md` / `UPDATE_2025-10-10.md` / `UPDATE_2025-10-11.md` / `UPDATE_2025-10-15.md` / `UPDATE_2025-10-16.md` / `UPDATE_2025-10-17.md` / **`UPDATE_2025-10-18.md`** / **`UPDATE_2025-10-19.md`** / **`UPDATE_2025-10-24.md`** - 每日更新日志
  - `README.md` - 发布说明
- **🆕 说明文档**：
  - `测试背景切换.md` - 完整的测试场景与验证清单
  - `动态壁纸使用指南.md` - 用户友好的使用说明
  - `功能完成总结.md` - 功能实现状态总结

## 功能特性

### 📖 长文本智能折叠（2025-10-19 新增）
- **✨ 自动折叠长回复**：Agent 响应超过阈值时自动显示折叠按钮
  - ✅ **智能检测**：超过 500 字符（可配置）自动折叠
  - ✅ **预览模式**：收起状态显示前 300 字符（可配置）+ "..."
  - ✅ **一键切换**：流畅展开/收起，无需重新渲染
  - ✅ **保持功能**：文本可选择、复制按钮正常工作
  - ✅ **仅对 Agent**：用户消息不受影响
- **🎨 精美样式**：
  - 🔴 红色渐变按钮（#FF6B6B → #EE5A6F）
  - ⚪ 白色文字，14px 圆角
  - 🖱️ Hover 效果：边框高亮 + 轻微放大
  - 💡 按钮文字："展开全文 ▼" / "收起 ▲"
- **⚙️ 完全可配置**：
  - 在设置中调整折叠阈值（100-5000 字符）
  - 设置收起时显示字符数（50-1000 字符）
  - 配置自动保存到统一的 `config.json`（路径：`SoftWare/Script/config.json`，键：`app.ui.collapse_threshold` 与 `app.ui.preview_length`）
- **📚 应用场景**：
  - 长代码片段：折叠代码，仅显示前几行
  - 详细说明：折叠长篇文字，需要时展开
  - 历史浏览：快速浏览对话，不被长文本占据屏幕
- **🔧 设置路径**：设置 → 通用设置 → 长文本折叠设置

### 🎬 静态/动态背景自由切换（2025-10-18 重大更新，2025-10-24 配置合并）
- **✨ 完美解决方案**：基于 QGraphicsVideoItem 架构，彻底解决 UI 被视频覆盖问题
  - ✅ **图片 → 视频**：无缝切换，即时生效
  - ✅ **视频 → 图片**：自动停止视频，恢复静态背景
  - ✅ **视频 → 视频**：流畅切换，无闪烁
  - ✅ **启动恢复**：自动恢复上次设置的背景类型（图片/视频）
- **🏗️ 架构升级**：
  - ❌ 旧方案：QVideoWidget（GPU 硬件层覆盖 Qt 软件层，UI 被遮挡）
  - ✅ 新方案：QGraphicsVideoItem（统一在 QGraphicsScene 内渲染）
    - 统一渲染上下文，精确 z-order 控制
    - 视频在 Scene 内享受硬件加速（zValue=-1000 最底层）
    - UI 在 Scene 外通过 `raise_()` 保证在上层
    - 鼠标事件穿透，所有交互正常
- **🎨 用户体验**：
  - 在设置中选择图片或视频文件，系统自动识别类型
  - 支持格式：图片（PNG/JPG/JPEG），视频（MP4/AVI/MOV/MKV）
  - 视频循环播放，静音模式
  - 深色模式完美兼容（蒙版正确覆盖在视频上）
  - 设置界面显示当前背景类型标签
- **💾 持久化**：
  - 背景设置自动保存到统一的 `config.json`
  - 包含 `is_video_background` 等标记（由增强主题管理器维护）
  - 应用启动时自动恢复
- **📚 完整文档**：
  - `测试背景切换.md` - 5个测试场景与验证清单
  - `UPDATE_2025-10-18.md` - 完整技术文档与架构说明
  - `动态壁纸使用指南.md` - 用户友好的使用说明
  - `功能完成总结.md` - 功能实现状态总结

### 🎬 动态视频背景（2025-10-17 新增 → 2025-10-18 完善）
- **视频壁纸支持**：使用视频文件作为UI背景
  - 支持格式：MP4, AVI, MOV, MKV, WebM
  - 自动循环播放，静音模式
  - 与静态图片背景无缝切换（已在 2025-10-18 完善）
- **技术架构**：
  - ~~基于 PyQt6 QMediaPlayer + FFmpeg 7.1.1 后端~~
  - **✅ [2025-10-18] 升级为 QGraphicsVideoItem 架构**，解决 UI 覆盖问题
  - 统一渲染场景设计，UI 组件自动位于视频上方
  - 智能文件类型检测，自动选择处理方式
- **设置方式**：
  - 点击"设置" → "通用设置" → "自定义背景" → 选择视频/图片文件
  - 支持实时切换，无需重启
  - **✅ [2025-10-18] 自动识别文件类型并显示标签**
- **已知限制**：
  - ⚠️ 需要系统多媒体后端支持（Windows: Media Feature Pack, Linux: GStreamer）
  - ⚠️ 推荐使用 H.264 编码的 MP4 文件
  - ⚠️ 视频解码会占用 CPU/GPU 资源

### 🆕 LLM Function Calling（2025-10-16 重大更新）
- **🤖 智能工具调用**：AI 自动判断何时需要调用外部工具
  - 🔍 **百度搜索**：获取实时网络信息，支持最新资讯、技术文档查询
    - 🆕 **时效性过滤**: `search_recency_filter` (day/week/month/year) - 确保信息时效性
    - 🆕 **网站限定**: `site_filter` - 限定权威网站，提高准确性
    - 💡 组合使用高级参数，显著提升天气、新闻等实时信息查询的准确率
  - 📊 AI 自动决策：无需手动触发，根据问题内容智能选择工具和参数
  - 🔄 两步走循环：LLM 决策 → 工具执行 → 上下文注入 → 最终答案
- **⚡ 多模型支持**：
  - ✅ DeepSeek：完整 Function Calling 支持
  - ✅ Gemini：完整 Function Calling 支持（格式适配）
  - ✅ OpenAI Compatible API：通用支持
- **🔧 可扩展架构**：
  - 工具注册表模式，轻松添加新工具（天气、计算器等）
  - 标准 JSON Schema 定义，兼容 OpenAI 规范
  - 自动 JSON 序列化和错误处理
- **📝 使用示例**：
  ```python
  # 用户: "请搜索最新的 Python 3.13 新特性"
  # AI 自动调用百度搜索 → 获取结果 → 生成准确回答
  response = get_ai_reply(messages, provider='deepseek', enable_tools=True)
  ```
- **环境配置**：
  ```powershell
  # 设置百度千帆 API Key
  $env:BAIDU_SEARCH_APIKEY = "your_api_key_here"
  ```
- **详细文档**：
  - Function Calling 框架: `UPDATE_2025-10-16_function_calling.md`
  - 高级参数使用: `BAIDU_SEARCHER_ADVANCED_PARAMS.md` 🆕

### 核心功能
- 支持多AI模型（Gemini/DeepSeek），可随时切换
- Gemini集成官方SDK，自动密钥管理，支持最新模型（gemini-2.5-flash）
- 聊天气泡自适应布局，内容包裹优先，最大宽度限制，换行撑满
- 自动代理配置，支持本地代理穿透防火墙
- 完善的配置诊断与修复脚本
- 详细的技术文档与更新日志
- 联网即可使用个人助手问答
- 本地保存对话记录不泄密
- 预设提示词提高问答效率
- 任务管理栏滚动播放任务名称
- UI界面可缩放至任意大小

### Stable Diffusion 本地绘画（2025-10-15/16 重大更新）
- **🎨 创作控制面板**：完整的参数调整界面
  - 采样器、调度器、步数、CFG（支持0.5精度）、种子、宽/高等
  - 动态单词计数（xx/75），超限颜色预警
  - 模型自动刷新与切换
  - 参数自动持久化，下次启动加载
- **⚡ 实时进度反馈**：
  - 🔌 连接 SD WebUI
  - 📝 正在生成提示词
  - 🎨 正在生成图片（带百分比）
  - 渐变背景+边框+图标，消除等待焦虑
- **🚀 快速生成模式**：直接输入描述即可生成
- **🔧 代理绕过**：修复全局代理导致的502错误

### 多模态文件支持（2025-10-10/16 更新）
- **📸 图片支持**：JPEG, PNG, GIF, WebP, HEIC, HEIF
  - < 20MB：内嵌上传（快速响应）
  - ≥ 20MB：File API 上传（服务器保留48小时）
- **📄 PDF支持**：完整的PDF文档理解
  - < 20MB：内嵌上传
  - ≥ 20MB：File API 上传
- **🎬 视频支持**：MP4, MOV, MPEG, AVI, WebM
  - 所有视频强制使用 File API（无论大小）
  - 最大支持 2GB 视频文件
  - 服务器保留48小时，支持多轮对话引用
- **文件引用显示**：用户/Agent气泡底部显示附件文件名
- **双重验证**：扩展名 + MIME类型白名单双重检查
- **智能路由**：根据文件类型和大小自动选择最优上传方式
- **时效性提示**：上传时明确显示"仅单次对话"或"仅保存48小时"

### 高级文本搜索功能（2025-10-05）
- 支持当前对话搜索和全局搜索
- 智能高亮显示：气泡背景高亮 + 关键词文本高亮（双重高亮）
- 搜索结果计数与导航："已查找到 X 处内容，现在显示的是 Y/X 处"
- 上一处/下一处快速导航按钮（找到2处及以上时自动显示）
- Ctrl+F 快捷键快速唤醒搜索对话框
- 搜索结果自动居中显示，3秒高亮后恢复
- 支持大小写不敏感匹配

## 未来开发计划

### 短期计划（优先级排序）
- 🔴 **[优先级1] 修复任务栏交互Bug**：重构 `file_manager.py` 消息解析逻辑，避免内容刷新为标题
- ~~🟡 **[优先级2] 视频背景优化**：添加视频预览缩略图、播放速度调整、淡入淡出效果~~
  - ✅ **[2025-10-18 已完成]** 静态/动态背景自由切换功能
  - ✅ **[2025-10-18 已完成]** 基于 QGraphicsVideoItem 架构解决 UI 覆盖问题
- ~~🟢 **[优先级3] 多媒体后端检测**：启动时检测 FFmpeg 可用性，提供用户友好的错误提示~~
  - 🔄 **降低优先级**：现有架构已稳定，待用户反馈后再优化
- 🟡 **[新增] 背景切换动画**：添加淡入淡出效果，提升视觉体验
- 集成model_registry.py到API客户端
- 为Claude、GPT-4o实现完整API调用逻辑
- SD参数预设功能（保存/加载多套常用参数）
- 进度条可视化（替代文字百分比）
- 优化视频文件的上传进度显示
- 添加视频缩略图预览功能
- 支持音频文件上传与语音识别

### 中期计划
- 动态壁纸商店（预置视频背景包）
- 视频背景自定义过滤器（模糊、亮度调整）
- 支持 GIF 动图作为背景
- 背景音乐播放器（独立于视频背景）
- 文件管理面板（查看已上传文件，管理生命周期）
- 多语言支持（UI国际化）
- 插件系统框架
- 加入图像生成功能（DALL-E, Midjourney等）
- 加入音频生成功能（TTS, 音乐生成）
- 多模态文件混合分析优化

### 长期计划
- WebGL 动态背景（粒子效果、波浪效果）
- 背景主题一键切换（预设多套方案）
- 社区背景分享平台
- 本地模型支持（Ollama、LM Studio等）
- 协作功能，多用户对话
- 移动端适配

## 📊 技术栈

- **前端框架**：PyQt6
- **AI SDK**：Google GenAI SDK, OpenAI SDK
- **多媒体**：PyQt6 QtMultimedia (FFmpeg 7.1.1 后端)
- **数据库**：SQLite（本地）/ ODBC（远程）
- **多模态**：Gemini File API, Vision API
- **网络**：自动代理配置，gRPC 认证隔离
- **测试**：自动化测试套件

## ⚠️ 已知问题（截至 2025-10-24）

### 🔴 高优先级问题

#### 任务栏交互Bug（文件存储模式）
- **问题描述**：点击Windows任务栏中的Agent图标后，聊天记录中的详细回复会被刷新成简短标题
- **影响范围**：仅影响文件存储模式，数据库模式不受影响
- **根本原因**：`file_manager.py` 的消息解析逻辑未正确区分标题和内容
- **临时解决方案**：
  1. 使用数据库存储模式（推荐）
  2. 避免在获得长回复后最小化窗口
  3. 创建新对话重新提问
- **修复计划**：V1.0.11 预期修复，重构文件格式和解析逻辑

### 🟡 中优先级问题

~~#### 视频背景多媒体后端依赖~~
- ✅ **[2025-10-18 已解决]** 基于 QGraphicsVideoItem 的新架构稳定运行
- 仅保留已知限制说明，不再视为问题

~~#### 视频背景性能影响~~
- ✅ **[2025-10-18 优化]** 使用硬件加速渲染，性能影响已优化
- 建议：使用分辨率较低的视频（720p），避免高帧率视频（推荐30fps）

### 🟢 低优先级问题

#### PyInstaller 打包缺失 DLL
- **问题描述**：打包后的程序可能缺少 Qt Multimedia DLL
- **解决方案**：在 .spec 文件中手动添加 `qtvideodecoder.dll`, `qtmedia.dll` 等
- **修复计划**：提供完整的打包配置模板

## 📝 更新日志

- **2025-10-24**：🎨 **UI/UX 优化三连击**
  - ✨ **气泡功能按钮动态对齐**：复制/删除/修改按钮根据鼠标在气泡内的垂直位置实时调整，离开后延迟 2 秒隐藏，边距收紧（AI 气泡从 10px 减至 3px），复制操作显示"已复制!"视觉反馈
  - 🎨 **SD 创作面板间距优化**：正向和负向提示词之间的水平间距从 12px 缩小到 8px，布局更紧凑统一
  - ⚙️ **设置面板即时刷新**：移除深色模式和自动模式开关的防抖机制，点击即响应；修复设置面板切换主题后不刷新的问题，现在立即应用新配色
  - 🔧 **技术改进**：新增事件过滤器捕获子控件鼠标事件，按钮位置全局边界保护，单次删除确认对话框
  - 📚 详细文档：`LOG/UPDATE_2025-10-24.md`（完整技术实现与测试清单）

- 2025-10-24（未发版变更，基于 2025-10-19 后续改进）
  - ✨ 气泡功能按钮（复制/删除/修改）支持随鼠标垂直位置动态对齐，离开后延迟隐藏；边距收紧并做全局边界保护；复制按钮支持"已复制"瞬时反馈；
  - 🎨 SD 创作控制面板布局收紧：顶部空白减少、控件间距与提示词文本框高度优化；
  - ⚙️ 配置整合：主题与长文本折叠相关设置合并至 `SoftWare/Script/config.json`，废弃 `theme_settings.json`；
  - 🧽 交互优化：删除消息时采用单次确认弹窗，避免重复确认；
  - 🧩 兼容性：历史消息加载与折叠逻辑保持不变；
  - 🗂️ 文档：更新项目结构与使用说明，说明配置迁移与新行为。

- **2025-10-19 (v1.0.10)**：📖 **长文本智能折叠 + 对话框背景修复**
  - ✨ **长文本折叠功能**：Agent 响应超过 500 字符（可配置）自动折叠，显示前 300 字符（可配置）
  - 🎨 **红色渐变按钮**：一键展开/收起，流畅自然，保持文本可选择和复制
  - ⚙️ **完全可配置**：在设置中调整折叠阈值（100-5000）和预览长度（50-1000）
  - 💾 **配置持久化**：设置自动保存到 `config.json`，重启后生效（2025-10-24 起合并至统一配置）
  - 🐛 **修复对话框背景透明问题**：使用 CSS 选择器（`QWidget#ChatWindow`）精确控制主窗口样式，不影响子组件
  - 🔧 **技术细节**：
    - 新增 `CollapsibleBubbleLabel` 类（`chat_area.py`）
    - 添加折叠配置界面（`dialogs.py`）
    - 修复 `chat_ui.py` 样式继承问题（主窗口样式不再影响对话框）
  - 📚 更新文档：`UPDATE_2025-10-19.md`（完整功能说明与修复细节）
  - 🎯 用户体验提升：长对话更易浏览，设置界面背景始终保持白色
- **2025-10-18 (v1.0.10)**：🎬 **静态/动态背景自由切换 - 完美解决方案**
  - ✅ **架构升级**：从 QVideoWidget 改为 QGraphicsVideoItem，彻底解决 UI 被视频覆盖问题
  - ✅ **统一渲染**：视频在 QGraphicsScene 内（zValue=-1000 最底层），UI 通过 raise_() 在上层
  - ✅ **自由切换**：支持图片→视频、视频→图片、视频→视频 所有切换场景
  - ✅ **启动恢复**：自动恢复上次设置的背景类型（通过 is_video_background 标记）
  - ✅ **鼠标穿透**：WA_TransparentForMouseEvents 确保所有 UI 交互正常
  - ✅ **深色模式兼容**：蒙版正确覆盖在视频上，不影响播放
  - 📝 修改文件：`chat_ui.py`（架构重构）、`enhanced_theme_manager.py`（视频标记）、`dialogs.py`（类型显示，后续配置写入 `config.json`）
  - 📚 新增文档：`测试背景切换.md`、`动态壁纸使用指南.md`、`功能完成总结.md`
  - 🎯 核心原理：从"控制分离的渲染层"改为"统一场景中精确控制层级"
  - 📖 详细文档：`UPDATE_2025-10-18.md`（完整技术架构与实现原理）
- **2025-10-17 (v1.0.9)**：🎬 **动态视频背景功能 + 任务栏Bug记录**
  - ✅ 新增视频背景播放功能（MP4/AVI/MOV/MKV），基于 PyQt6 QMediaPlayer
  - ✅ 独立视频层架构，支持循环播放、自动静音、层级管理
  - ✅ 关键修复：样式表清除机制，避免CSS覆盖视频组件
  - ✅ 智能文件类型检测，自动区分视频/图片处理逻辑
  - ✅ 新增6个诊断测试工具，验证视频功能完整性
  - ⚠️ 记录任务栏交互Bug（文件存储模式下消息内容刷新为标题），解决方案方向已明确
  - 📚 详细文档：`UPDATE_2025-10-17.md`（10步初始化流程、故障排查指南）
- **2025-10-16 (v1.3.1)**：🔧 **Function Calling 增强：高级搜索参数**
  - 🆕 新增 `search_recency_filter`：时效性过滤（day/week/month/year）
  - 🆕 新增 `site_filter`：网站限定（支持最多20个权威站点）
  - 📝 更新 `baidu_searcher.py` 工具 Schema，LLM 可自动使用高级参数
  - 🎯 显著提升天气、新闻等实时信息查询的准确性
  - 📚 新增完整文档：`BAIDU_SEARCHER_ADVANCED_PARAMS.md`
  - 🧪 新增4个测试用例验证高级参数功能
- **2025-10-16 (v1.3.0)**：🤖 **重大更新：Function Calling 框架**
  - ✅ 新增 `baidu_searcher.py`（270行）：百度千帆搜索工具封装
  - ✅ 新增 `tool_executor.py`（280行）：通用工具执行器和注册管理
  - ✅ 升级 `api_client.py`：完整实现 DeepSeek、Gemini 的 Function Calling 支持
  - ✅ 新增 `test_function_calling.py`（260行）：完整测试套件（5个测试场景）
  - 🔄 两步走循环：LLM 决策 → 工具执行 → 上下文注入 → 最终答案
  - 📚 新增 `UPDATE_2025-10-16_function_calling.md`：完整技术文档
  - 🎯 应用场景：实时信息查询、知识增强、智能问答
  - 🔧 可扩展架构：轻松添加天气、计算器等新工具
- **2025-10-16**：🎨 用户体验优化三连击：(1)创作面板去边框+动态单词计数(xx/75)颜色预警；(2)SD生成进度实时反馈（渐变背景+图标+步骤详情）；(3)代码结构重构（model_registry.py统一模型配置，sd_config.py参数持久化）
- **2025-10-15**：🎨 新增 Stable Diffusion 创作控制面板（CFG 支持 0.5 步长、数值框移除上下按钮、滚轮微调精度优化），并修复 SD WebUI 在全局代理下被劫持导致的 502 问题；新增模型自动刷新与切换支持。
- **2025-10-10**：✨ 完全支持视频附件，用户气泡底部有引用文件显示，优化UI交互
- **2025-10-10**：✨ Gemini 视频理解支持，文件类型重构（仅图片/PDF/视频），气泡文件引用显示
- **2025-10-09**：🔧 修复 Gemini 文件上传代理冲突
- **2025-10-08**：🐛 气泡布局修复，文件上传优化
- **2025-10-05**：🔍 高级文本搜索功能
- **2025-09-30**：🎨 气泡自适应布局优化
- **2025-09-28**：🌓 深色模式与主题管理

详见 `LOG/` 目录下的详细更新日志。

## 🤝 贡献指南

请遵循开发准则（见文档顶部），所有改动需要：
1. 记录到日志文件夹 LOG
2. 更新 README 项目结构
3. 完成开发链条：idea → 目的 → 必要性 → 可行性 → 执行
4. 每日存档提交到 GitHub
5. 协调开发时间，确保单人编辑

## 📧 联系方式

- Email: 946163076@QQ.com
- Issues: 欢迎提交问题和建议

## 📄 许可证

本项目仅供学习和个人使用。